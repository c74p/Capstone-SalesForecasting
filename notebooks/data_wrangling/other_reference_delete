import cauldron as cd
import os
import pandas as pd

# Read in the files in the directory
# Ignoring file test.csv since we don't have target values for it
PROJ_ROOT = os.path.abspath(os.path.join(os.pardir, os.pardir))
files = {}
for prefix in ['train', 'weather', 'store_states', 'state_names', 'store',
               'googletrend']:
    file_path = os.path.join(PROJ_ROOT, 'data', 'raw', prefix + '.csv')
    files[prefix] = pd.read_csv(file_path, header=0, low_memory=False)
    cd.display.table(files[prefix].head())

df = files['train']
print(df.shape)
print(df.isnull().count())
df = pd.merge(df, files['store_states'], on='Store')
print(df.shape)
print(df.isnull().count())
cd.display.table(df.head())
